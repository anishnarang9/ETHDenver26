(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[89],{80:(e,s,a)=>{"use strict";a.d(s,{GuardrailsPanel:()=>c});var t=a(5155),i=a(2115),n=a(9556),r=a(4648);let l=e=>e.split(",").map(e=>e.trim()).filter(Boolean);function c(){let[e,s]=(0,i.useState)("0xe95C796f820217bC745727761Ce7F4882B51fe7E"),[a,c]=(0,i.useState)(n.u.createRandom().address),[o,d]=(0,i.useState)("travel,transport,food,events,search,booking"),[u,p]=(0,i.useState)("gateway,planner,rider,foodie,eventbot"),[h,m]=(0,i.useState)("24"),[x,v]=(0,i.useState)("2000000000000000000"),[g,N]=(0,i.useState)("20000000000000000000"),[b,w]=(0,i.useState)("30"),[S,f]=(0,i.useState)("No on-chain writes yet."),y=Math.floor(Date.now()/1e3)+3600*Number(h||"0"),C=async()=>{try{let s=await (0,r._f)({agentAddress:e,expiresAt:y,perCallCap:x,dailyCap:g,rateLimitPerMin:Number(b),scopes:l(o),services:l(u)});f("Passport updated: ".concat(s.txHash))}catch(e){f("Upsert failed: ".concat(e.message))}},E=async()=>{try{let s=await (0,r.HM)({agentAddress:e,sessionAddress:a,expiresAt:y,scopes:l(o)});f("Session granted: ".concat(s.txHash))}catch(e){f("Session grant failed: ".concat(e.message))}},j=async()=>{try{let s=await (0,r.$V)({agentAddress:e});f("Passport revoked: ".concat(s.txHash))}catch(e){f("Revoke failed: ".concat(e.message))}};return(0,t.jsxs)("div",{className:"panel",style:{marginTop:14},children:[(0,t.jsx)("h3",{className:"panel-title",children:"Passport and Session Controls"}),(0,t.jsxs)("div",{className:"field-grid",style:{marginTop:12},children:[(0,t.jsxs)("div",{className:"field",children:[(0,t.jsx)("label",{className:"label",children:"Agent Address"}),(0,t.jsx)("input",{className:"input mono",value:e,onChange:e=>s(e.target.value)})]}),(0,t.jsxs)("div",{className:"field",children:[(0,t.jsx)("label",{className:"label",children:"Session Address"}),(0,t.jsx)("input",{className:"input mono",value:a,onChange:e=>c(e.target.value)})]}),(0,t.jsxs)("div",{className:"field",children:[(0,t.jsx)("label",{className:"label",children:"Scopes (csv)"}),(0,t.jsx)("input",{className:"input",value:o,onChange:e=>d(e.target.value)})]}),(0,t.jsxs)("div",{className:"field",children:[(0,t.jsx)("label",{className:"label",children:"Services (csv)"}),(0,t.jsx)("input",{className:"input",value:u,onChange:e=>p(e.target.value)})]}),(0,t.jsxs)("div",{className:"field",children:[(0,t.jsx)("label",{className:"label",children:"Per Call Cap (atomic)"}),(0,t.jsx)("input",{className:"input mono",value:x,onChange:e=>v(e.target.value)})]}),(0,t.jsxs)("div",{className:"field",children:[(0,t.jsx)("label",{className:"label",children:"Daily Cap (atomic)"}),(0,t.jsx)("input",{className:"input mono",value:g,onChange:e=>N(e.target.value)})]}),(0,t.jsxs)("div",{className:"field",children:[(0,t.jsx)("label",{className:"label",children:"Rate Limit / Min"}),(0,t.jsx)("input",{className:"input",value:b,onChange:e=>w(e.target.value)})]}),(0,t.jsxs)("div",{className:"field",children:[(0,t.jsx)("label",{className:"label",children:"Expiry (hours)"}),(0,t.jsx)("input",{className:"input",value:h,onChange:e=>m(e.target.value)})]})]}),(0,t.jsxs)("div",{className:"inline-actions",style:{marginTop:12},children:[(0,t.jsx)("button",{className:"primary-button",onClick:C,children:"Upsert Passport"}),(0,t.jsx)("button",{className:"secondary-button",onClick:E,children:"Grant Session"}),(0,t.jsx)("button",{className:"danger-button",onClick:j,children:"Revoke Passport"})]}),(0,t.jsx)("div",{className:"event-item",style:{marginTop:10},children:(0,t.jsx)("div",{style:{fontSize:12,color:"var(--text-2)"},children:S})})]})}},4267:(e,s,a)=>{Promise.resolve().then(a.bind(a,80)),Promise.resolve().then(a.bind(a,9268))},4648:(e,s,a)=>{"use strict";a.d(s,{$V:()=>g,HM:()=>v,_f:()=>x});var t=a(582),i=a(8982),n=a(8823),r=a(6943),l=a(1905);let c=["function upsertPassport(address agent,uint64 expiresAt,uint128 perCallCap,uint128 dailyCap,uint32 rateLimitPerMin,bytes32[] scopes,bytes32[] services)","function revokePassport(address agent)","function getPassport(address agent) view returns (address owner,address agentAddress,uint64 expiresAt,uint128 perCallCap,uint128 dailyCap,uint32 rateLimitPerMin,bool revoked,uint32 version,uint64 updatedAt,bytes32[] scopes,bytes32[] services)"],o=["function grantSession(address agent,address session,uint64 expiresAt,bytes32[] scopeSubset)","function isSessionActive(address session) view returns (bool)"],d=()=>{var e,s;let a=globalThis,t=null!==(s=null===(e=a.window)||void 0===e?void 0:e.ethereum)&&void 0!==s?s:a.ethereum;if(!t)throw Error("No EVM wallet found. Install or unlock MetaMask.");return t},u=(e,s)=>{if(!e||!e.startsWith("0x"))throw Error("".concat(s," is missing. Set it in apps/web/.env.local"));return e},p=async(e,s)=>{let a="0x".concat(Number(s).toString(16));try{await e.request({method:"wallet_switchEthereumChain",params:[{chainId:a}]})}catch(s){if(4902===s.code)await e.request({method:"wallet_addEthereumChain",params:[{chainId:a,chainName:"Kite AI Testnet",nativeCurrency:{name:"KITE",symbol:"KITE",decimals:18},rpcUrls:["https://rpc-testnet.gokite.ai/"],blockExplorerUrls:["https://testnet.kitescan.ai"]}]});else throw s}},h=async()=>{let e=d(),s=new t.k(e),a="2368",i=await s.getNetwork();return a&&Number(i.chainId)!==Number(a)?(await p(e,a),new t.k(e).getSigner()):s.getSigner()},m=e=>{let s="https://testnet.kitescan.ai";return s?"".concat(s.replace(/\/$/,""),"/tx/").concat(e):null},x=async e=>{if((await N(e.agentAddress)).exists)return{txHash:"already-exists",explorerLink:null,skipped:!0};let s=await h(),a=u("0x6c01C9815e747Ebdf86C0a75eEA93463e5e83626","NEXT_PUBLIC_PASSPORT_REGISTRY_ADDRESS"),t=new i.NZ(a,c,s),r=await t.upsertPassport(e.agentAddress,e.expiresAt,BigInt(e.perCallCap),BigInt(e.dailyCap),e.rateLimitPerMin,e.scopes.map(e=>n.id(e)),e.services.map(e=>n.id(e)));return await r.wait(),{txHash:r.hash,explorerLink:m(r.hash)}},v=async e=>{if(await b(e.sessionAddress))return{txHash:"already-exists",explorerLink:null,skipped:!0};let s=await h(),a=u("0x3da599e5D01B8d3B90bC95eD65bf7fE6A5DEFb15","NEXT_PUBLIC_SESSION_REGISTRY_ADDRESS"),t=new i.NZ(a,o,s),r=await t.grantSession(e.agentAddress,e.sessionAddress,e.expiresAt,e.scopes.map(e=>n.id(e)));return await r.wait(),{txHash:r.hash,explorerLink:m(r.hash)}},g=async e=>{let s=await h(),a=u("0x6c01C9815e747Ebdf86C0a75eEA93463e5e83626","NEXT_PUBLIC_PASSPORT_REGISTRY_ADDRESS"),t=new i.NZ(a,c,s),n=await t.revokePassport(e.agentAddress);return await n.wait(),{txHash:n.hash,explorerLink:m(n.hash)}},N=async e=>{try{let s=new r.FR("https://rpc-testnet.gokite.ai/"),a=u("0x6c01C9815e747Ebdf86C0a75eEA93463e5e83626","NEXT_PUBLIC_PASSPORT_REGISTRY_ADDRESS"),t=new i.NZ(a,c,s),n=await t.getPassport(e),o=n[0],d=Number(n[2]),p=n[6];if(o===l.j)return{exists:!1};let h=d>0&&Math.floor(Date.now()/1e3)>=d;if(p)return{exists:!1,owner:o,revoked:!0};if(h)return{exists:!1,owner:o,expired:!0};return{exists:!0,owner:o}}catch(e){return{exists:!1}}},b=async e=>{try{let s=new r.FR("https://rpc-testnet.gokite.ai/"),a=u("0x3da599e5D01B8d3B90bC95eD65bf7fE6A5DEFb15","NEXT_PUBLIC_SESSION_REGISTRY_ADDRESS"),t=new i.NZ(a,o,s);return await t.isSessionActive(e)}catch(e){return!1}}},9268:(e,s,a)=>{"use strict";a.d(s,{PageHeader:()=>n});var t=a(5155),i=a(9124);function n(e){let{title:s,subtitle:a,action:n}=e;return(0,t.jsxs)(i.P.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.35},style:{display:"flex",alignItems:"center",justifyContent:"space-between",gap:10},children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{className:"page-title",children:s}),(0,t.jsx)("p",{className:"page-subtitle",children:a})]}),n]})}}},e=>{var s=s=>e(e.s=s);e.O(0,[124,582,556,441,587,358],()=>s(4267)),_N_E=e.O()}]);
(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[404],{2922:(e,t,a)=>{"use strict";a.d(t,{TimelineWorkbench:()=>l});var s=a(5155),n=a(2115),i=a(5534);function l(){let[e,t]=(0,n.useState)([]),[a,l]=(0,n.useState)(""),[c,r]=(0,n.useState)("No action selected."),[o,d]=(0,n.useState)("idle"),[h,m]=(0,n.useState)("0xe95C796f820217bC745727761Ce7F4882B51fe7E");(0,n.useEffect)(()=>{let e=!0,a=async()=>{try{let a=new Set;a.add("0xe95C796f820217bC745727761Ce7F4882B51fe7E"),a.add("0xabbE116582398C54938B84069a23585Fb4470Bd6"),a.add("0xabbE116582398C54938B84069a23585Fb4470Bd6"),a.add("0xabbE116582398C54938B84069a23585Fb4470Bd6");try{let e=await fetch("".concat("https://kite-planner.onrender.com","/api/agents"),{cache:"no-store"});if(e.ok)for(let t of(await e.json()).agents||[])t.address&&a.add(t.address)}catch(e){}let s=Array.from(a).filter(Boolean);if(0===s.length){e&&(t([]),d("No agent addresses available to query."));return}let n=await Promise.allSettled(s.map(e=>(0,i.k$)(e))),l=[];for(let e of n)"fulfilled"===e.status&&l.push(...e.value.events);let c=Array.from(new Map(l.map(e=>[e.id,e])).values()).sort((e,t)=>new Date(t.createdAt).getTime()-new Date(e.createdAt).getTime());e&&(t(c),d("Loaded ".concat(c.length," events across ").concat(s.length," agents")),s.length>0&&m(e=>e||s[0]||""))}catch(t){e&&d("Timeline unavailable: ".concat(t.message))}};a();let s=setInterval(()=>{a()},4e3);return()=>{e=!1,clearInterval(s)}},[]);let p=(0,n.useMemo)(()=>{let t=new Map;for(let a of e){let e=t.get(a.actionId)||[];e.push(a),t.set(a.actionId,e)}return Array.from(t.entries())},[e]),u=async e=>{l(e);try{let t=await (0,i.Th)(e);r(JSON.stringify(t,null,2))}catch(e){r("Action lookup failed: ".concat(e.message))}},y=async()=>{if(!h){r("No agent address available for passport lookup.");return}try{let e=await (0,i.h0)(h);r(JSON.stringify(e,null,2))}catch(e){r("Passport lookup failed: ".concat(e.message))}};return(0,s.jsxs)("div",{style:{marginTop:14},children:[(0,s.jsxs)("div",{className:"panel",children:[(0,s.jsx)("h3",{className:"panel-title",children:"Timeline Query"}),(0,s.jsx)("div",{style:{marginTop:10,fontSize:12,color:"var(--text-2)"},children:o})]}),(0,s.jsxs)("div",{className:"console-grid",style:{marginTop:12},children:[(0,s.jsxs)("div",{className:"panel",children:[(0,s.jsx)("h3",{className:"panel-title",children:"Actions"}),(0,s.jsxs)("div",{className:"timeline-list",style:{marginTop:10},children:[0===p.length&&(0,s.jsx)("div",{className:"event-item",children:"No events yet."}),p.map(e=>{var t;let[a,n]=e;return(0,s.jsxs)("div",{className:"event-item",children:[(0,s.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",gap:8},children:[(0,s.jsx)("strong",{className:"mono",style:{fontSize:11},children:a}),(0,s.jsx)("button",{className:"secondary-button",onClick:()=>void u(a),children:"Inspect"})]}),(0,s.jsxs)("div",{style:{marginTop:6,fontSize:12,color:"var(--text-2)"},children:["route: ",null===(t=n[0])||void 0===t?void 0:t.routeId]}),(0,s.jsx)("div",{style:{marginTop:6,display:"grid",gap:4},children:n.slice(0,5).map(e=>(0,s.jsxs)("div",{className:"mono",style:{fontSize:11,color:"var(--text-2)"},children:[new Date(e.createdAt).toLocaleTimeString()," ",e.eventType]},e.id))})]},a)})]})]}),(0,s.jsxs)("div",{className:"panel",children:[(0,s.jsx)("h3",{className:"panel-title",children:"Evidence Inspector"}),(0,s.jsxs)("div",{className:"inline-actions",style:{marginTop:10},children:[(0,s.jsx)("button",{className:"secondary-button",onClick:()=>void u(a),disabled:!a,children:"Refresh Action"}),(0,s.jsx)("button",{className:"secondary-button",onClick:()=>void y(),children:"Load Passport"})]}),(0,s.jsx)("textarea",{className:"textarea mono",readOnly:!0,value:c,style:{marginTop:10,minHeight:430}})]})]})]})}},5534:(e,t,a)=>{"use strict";a.d(t,{Th:()=>l,h0:()=>c,k$:()=>i,s$:()=>s});let s="https://kite-gateway.onrender.com";async function n(e){if(!e.ok)throw Error(await e.text());return e.json()}let i=async e=>n(await fetch("".concat(s,"/api/timeline/").concat(e),{cache:"no-store"})),l=async e=>n(await fetch("".concat(s,"/api/actions/").concat(e),{cache:"no-store"})),c=async e=>n(await fetch("".concat(s,"/api/passport/").concat(e),{cache:"no-store"}))},6581:(e,t,a)=>{Promise.resolve().then(a.bind(a,9268)),Promise.resolve().then(a.bind(a,2922))},9268:(e,t,a)=>{"use strict";a.d(t,{PageHeader:()=>i});var s=a(5155),n=a(9124);function i(e){let{title:t,subtitle:a,action:i}=e;return(0,s.jsxs)(n.P.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.35},style:{display:"flex",alignItems:"center",justifyContent:"space-between",gap:10},children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h2",{className:"page-title",children:t}),(0,s.jsx)("p",{className:"page-subtitle",children:a})]}),i]})}}},e=>{var t=t=>e(e.s=t);e.O(0,[124,441,587,358],()=>t(6581)),_N_E=e.O()}]);
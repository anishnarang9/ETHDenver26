(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[520],{4648:(e,t,a)=>{"use strict";a.d(t,{$V:()=>f,HM:()=>E,_f:()=>g});var s=a(582),n=a(8982),r=a(8823),i=a(6943),l=a(1905);let o=["function upsertPassport(address agent,uint64 expiresAt,uint128 perCallCap,uint128 dailyCap,uint32 rateLimitPerMin,bytes32[] scopes,bytes32[] services)","function revokePassport(address agent)","function getPassport(address agent) view returns (address owner,address agentAddress,uint64 expiresAt,uint128 perCallCap,uint128 dailyCap,uint32 rateLimitPerMin,bool revoked,uint32 version,uint64 updatedAt,bytes32[] scopes,bytes32[] services)"],d=["function grantSession(address agent,address session,uint64 expiresAt,bytes32[] scopeSubset)","function isSessionActive(address session) view returns (bool)"],c=()=>{var e,t;let a=globalThis,s=null!==(t=null===(e=a.window)||void 0===e?void 0:e.ethereum)&&void 0!==t?t:a.ethereum;if(!s)throw Error("No EVM wallet found. Install or unlock MetaMask.");return s},u=(e,t)=>{if(!e||!e.startsWith("0x"))throw Error("".concat(t," is missing. Set it in apps/web/.env.local"));return e},p=async(e,t)=>{let a="0x".concat(Number(t).toString(16));try{await e.request({method:"wallet_switchEthereumChain",params:[{chainId:a}]})}catch(t){if(4902===t.code)await e.request({method:"wallet_addEthereumChain",params:[{chainId:a,chainName:"Kite AI Testnet",nativeCurrency:{name:"KITE",symbol:"KITE",decimals:18},rpcUrls:["https://rpc-testnet.gokite.ai/"],blockExplorerUrls:["https://testnet.kitescan.ai"]}]});else throw t}},h=async()=>{let e=c(),t=new s.k(e),a="2368",n=await t.getNetwork();return a&&Number(n.chainId)!==Number(a)?(await p(e,a),new s.k(e).getSigner()):t.getSigner()},m=e=>{let t="https://testnet.kitescan.ai";return t?"".concat(t.replace(/\/$/,""),"/tx/").concat(e):null},g=async e=>{if((await y(e.agentAddress)).exists)return{txHash:"already-exists",explorerLink:null,skipped:!0};let t=await h(),a=u("0x6c01C9815e747Ebdf86C0a75eEA93463e5e83626","NEXT_PUBLIC_PASSPORT_REGISTRY_ADDRESS"),s=new n.NZ(a,o,t),i=await s.upsertPassport(e.agentAddress,e.expiresAt,BigInt(e.perCallCap),BigInt(e.dailyCap),e.rateLimitPerMin,e.scopes.map(e=>r.id(e)),e.services.map(e=>r.id(e)));return await i.wait(),{txHash:i.hash,explorerLink:m(i.hash)}},E=async e=>{if(await v(e.sessionAddress))return{txHash:"already-exists",explorerLink:null,skipped:!0};let t=await h(),a=u("0x3da599e5D01B8d3B90bC95eD65bf7fE6A5DEFb15","NEXT_PUBLIC_SESSION_REGISTRY_ADDRESS"),s=new n.NZ(a,d,t),i=await s.grantSession(e.agentAddress,e.sessionAddress,e.expiresAt,e.scopes.map(e=>r.id(e)));return await i.wait(),{txHash:i.hash,explorerLink:m(i.hash)}},f=async e=>{let t=await h(),a=u("0x6c01C9815e747Ebdf86C0a75eEA93463e5e83626","NEXT_PUBLIC_PASSPORT_REGISTRY_ADDRESS"),s=new n.NZ(a,o,t),r=await s.revokePassport(e.agentAddress);return await r.wait(),{txHash:r.hash,explorerLink:m(r.hash)}},y=async e=>{try{let t=new i.FR("https://rpc-testnet.gokite.ai/"),a=u("0x6c01C9815e747Ebdf86C0a75eEA93463e5e83626","NEXT_PUBLIC_PASSPORT_REGISTRY_ADDRESS"),s=new n.NZ(a,o,t),r=await s.getPassport(e),d=r[0],c=Number(r[2]),p=r[6];if(d===l.j)return{exists:!1};let h=c>0&&Math.floor(Date.now()/1e3)>=c;if(p)return{exists:!1,owner:d,revoked:!0};if(h)return{exists:!1,owner:d,expired:!0};return{exists:!0,owner:d}}catch(e){return{exists:!1}}},v=async e=>{try{let t=new i.FR("https://rpc-testnet.gokite.ai/"),a=u("0x3da599e5D01B8d3B90bC95eD65bf7fE6A5DEFb15","NEXT_PUBLIC_SESSION_REGISTRY_ADDRESS"),s=new n.NZ(a,d,t);return await s.isSessionActive(e)}catch(e){return!1}}},5113:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>b});var s=a(5155),n=a(2115),r=a(8173),i=a.n(r);let l=(0,a(7401).A)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]),o={standby:"var(--text-2)",active:"var(--ok)",closed:"var(--warn)",revoked:"var(--danger)"};function d(e){let{label:t,browser:a,thought:n}=e,r=(null==a?void 0:a.status)||"standby",i=(null==a?void 0:a.liveViewUrl)||"",l=!!((null==a?void 0:a.liveViewUrl)&&"active"===r),d=!!(null==n?void 0:n.trim()),c=!l&&d;return(0,s.jsxs)("div",{className:"agent-card",children:[(0,s.jsxs)("div",{className:"agent-head",children:[(0,s.jsx)("strong",{children:t}),(0,s.jsx)("span",{className:"badge",style:{color:o[r],borderColor:"".concat(o[r],"66")},children:r})]}),(0,s.jsx)("div",{className:"agent-body",children:l?(0,s.jsx)("iframe",{src:i,title:"".concat(t," browser"),style:{width:"100%",height:"100%",border:"none"},sandbox:"allow-scripts allow-same-origin"}):c?(0,s.jsxs)("div",{style:{height:"100%",display:"grid",alignContent:"start",gap:8,padding:10,color:"var(--text-0)"},children:[(0,s.jsx)("span",{className:"badge ok",style:{width:"fit-content"},children:"Live Output"}),(0,s.jsx)("div",{style:{fontSize:12,lineHeight:1.5,color:"var(--text-1)",overflow:"auto",maxHeight:156},children:n})]}):(0,s.jsx)("div",{style:{display:"grid",placeItems:"center",height:"100%",color:"var(--text-2)",fontSize:12},children:"revoked"===r?"Agent access revoked":"No active live browser stream"})}),n&&!c&&(0,s.jsx)("div",{style:{borderTop:"1px solid var(--line)",padding:"8px",fontSize:12,color:"var(--text-1)"},children:n})]})}function c(e){let{emails:t}=e;return 0===t.length?(0,s.jsx)("div",{className:"event-item",children:"Waiting for agent or human emails."}):(0,s.jsx)("div",{className:"email-list",children:t.slice().reverse().map(e=>(0,s.jsxs)("div",{className:"email-item",children:[(0,s.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",gap:8},children:[(0,s.jsx)("strong",{children:e.from}),(0,s.jsx)("span",{className:"mono",style:{color:"var(--text-2)",fontSize:11},children:new Date(e.timestamp).toLocaleTimeString()})]}),e.subject&&(0,s.jsx)("div",{style:{marginTop:3,fontSize:13},children:e.subject}),(0,s.jsx)("div",{style:{marginTop:4,fontSize:12,color:"var(--text-2)",whiteSpace:"pre-wrap"},children:e.body})]},e.id))})}let u=["IDENTITY_VERIFIED","SESSION_VERIFIED","PASSPORT_VERIFIED","SCOPE_VERIFIED","SERVICE_VERIFIED","RATE_LIMIT_VERIFIED","BUDGET_VERIFIED","QUOTE_ISSUED","PAYMENT_VERIFIED","RECEIPT_RECORDED"],p={IDENTITY_VERIFIED:"Identity",SESSION_VERIFIED:"Session",PASSPORT_VERIFIED:"Passport",SCOPE_VERIFIED:"Scope",SERVICE_VERIFIED:"Service",RATE_LIMIT_VERIFIED:"Rate",BUDGET_VERIFIED:"Budget",QUOTE_ISSUED:"Quote",PAYMENT_VERIFIED:"Payment",RECEIPT_RECORDED:"Receipt",REQUEST_BLOCKED:"Blocked"};function h(e){let{steps:t}=e;return 0===t.length?(0,s.jsx)("div",{className:"event-item",children:"Awaiting enforcement evidence."}):(0,s.jsx)("div",{className:"timeline-list",children:t.map((e,t)=>(0,s.jsxs)("div",{className:"event-item",children:[(0,s.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",gap:8},children:[(0,s.jsxs)("strong",{children:[e.step,". ",p[e.name]||e.name]}),(0,s.jsx)("span",{className:"badge ".concat("pass"===e.status?"ok":"fail"===e.status?"danger":"warn"),children:e.status})]}),e.detail&&(0,s.jsx)("div",{style:{marginTop:4,color:"var(--text-2)",fontSize:12},children:e.detail})]},"".concat(e.step,"-").concat(e.name,"-").concat(t)))})}var m=a(4648);function g(e){let{transactions:t}=e;return 0===t.length?(0,s.jsx)("div",{className:"event-item",children:"No payment activity yet."}):(0,s.jsx)("div",{className:"feed-list",children:t.slice().reverse().map(e=>(0,s.jsxs)("div",{className:"feed-item",children:[(0,s.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",gap:8},children:[(0,s.jsxs)("strong",{children:[e.from," to ",e.to]}),(0,s.jsx)("span",{className:"badge ".concat("complete"===e.status?"ok":"failed"===e.status?"danger":"warn"),children:e.status})]}),(0,s.jsxs)("div",{className:"mono",style:{marginTop:4,fontSize:11,color:"var(--text-2)"},children:["amount=",e.amount||"0"," method=",e.method]}),e.txHash&&(0,s.jsx)("a",{href:"".concat("https://testnet.kitescan.ai","/tx/").concat(e.txHash),target:"_blank",rel:"noreferrer",className:"mono",style:{marginTop:4,display:"inline-block",fontSize:11,color:"var(--accent-cyan)"},children:"view on explorer"})]},e.id))})}var E=a(7174);function f(e){let{transactions:t,plannerUrl:a}=e,[r,i]=(0,n.useState)("Idle"),{state:l}=(0,E.k)(),o=!!l.orchestratorPhase&&"completed"!==l.orchestratorPhase&&"killed"!==l.orchestratorPhase,d="0xe95C796f820217bC745727761Ce7F4882B51fe7E",c=(0,n.useMemo)(()=>[{key:"plan-trip",label:"Run Demo",className:"primary-button"},{key:"additional-search",label:"Additional Search",className:"secondary-button"},{key:"scope-violation",label:"Scope Violation",className:"secondary-button"},{key:"post-revoke-test",label:"Post Revoke Test",className:"secondary-button"}],[]),u=async e=>{i("Triggering ".concat(e,"..."));try{var t;let s=await fetch("".concat(a,"/api/trigger"),{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify({action:e})});if(!s.ok)throw Error(await s.text());let n=await s.json();i("".concat(e," started (run ").concat((null===(t=n.runId)||void 0===t?void 0:t.slice(0,8))||"n/a",")"))}catch(e){i("Error: ".concat(e.message))}},p=async()=>{i("Sending kill signal...");try{let e=await fetch("".concat(a,"/api/kill"),{method:"POST"});if(!e.ok)throw Error(await e.text());i("All agents killed.")}catch(e){i("Kill failed: ".concat(e.message))}},h=async()=>{if(!d){i("No revoke address configured in NEXT_PUBLIC_PLANNER_ADDRESS or NEXT_PUBLIC_EVENTBOT_ADDRESS");return}i("Submitting revoke transaction...");try{let e=await (0,m.$V)({agentAddress:d});i("Revoked ".concat(d.slice(0,10)," via ").concat(e.txHash.slice(0,10),"..."))}catch(e){i("Revoke failed: ".concat(e.message))}};return(0,s.jsxs)("div",{className:"panel",children:[(0,s.jsx)("h3",{className:"panel-title",children:"Mission Control"}),(0,s.jsxs)("div",{className:"inline-actions",style:{marginTop:10},children:[c.map(e=>(0,s.jsx)("button",{className:e.className,onClick:()=>{u(e.key)},children:e.label},e.key)),(0,s.jsx)("button",{className:"danger-button",onClick:h,children:"Revoke Passport"}),(0,s.jsx)("button",{className:"danger-button",onClick:()=>void p(),disabled:!o,children:"Kill Agents"})]}),(0,s.jsxs)("div",{className:"event-item",style:{marginTop:10},children:[(0,s.jsx)("strong",{children:"Status"}),(0,s.jsx)("div",{style:{marginTop:4,fontSize:12,color:"var(--text-2)"},children:r})]}),(0,s.jsxs)("div",{style:{marginTop:10},children:[(0,s.jsx)("h4",{style:{margin:0,fontSize:13,color:"var(--text-1)"},children:"Transactions"}),(0,s.jsx)("div",{style:{marginTop:8},children:(0,s.jsx)(g,{transactions:t})})]})]})}function y(e){let{plannerUrl:t}=e,[a,r]=(0,n.useState)(!1),{switchUrl:i,dispatch:l}=(0,E.k)(),o=async()=>{try{var e,a;let s=await fetch("".concat(t,"/api/runs"));if(!s.ok)return;let n=await s.json(),o=null===(a=n.runs)||void 0===a?void 0:null===(e=a[0])||void 0===e?void 0:e.runId;if(!o)return;l({type:"RESET"}),i("".concat(t,"/api/replay/").concat(o)),r(!0)}catch(e){}};return(0,s.jsx)("button",{className:"secondary-button",onClick:a?()=>{l({type:"RESET"}),i("".concat(t,"/api/events")),r(!1)}:o,children:a?"Back to Live":"Replay Latest Run"})}var v=a(6943),x=a(8982);let w=["function balanceOf(address) view returns (uint256)"];function N(e){let{wallets:t}=e;return(0,s.jsxs)("div",{className:"panel",children:[(0,s.jsx)("h3",{className:"panel-title",children:"Agent Wallets"}),(0,s.jsx)("div",{className:"feed-list",style:{marginTop:10},children:t.map((e,t)=>(0,s.jsx)(S,{wallet:e},"".concat(e.name,"-").concat(e.address,"-").concat(t)))})]})}function S(e){let{wallet:t}=e,{balance:a,direction:r,isPolling:i}=function(e,t,a){let[s,r]=(0,n.useState)("0.00"),[i,l]=(0,n.useState)("0.00"),[o,d]=(0,n.useState)("none"),[c,u]=(0,n.useState)(!1),p=(0,n.useRef)("0.00");return(0,n.useEffect)(()=>{if(!e||!a)return;let s=new v.FR(t||"https://rpc-testnet.gokite.ai/"),n=new x.NZ(a,w,s),i=async()=>{u(!0);try{let t=0,a=0;try{let a=await s.getBalance(e);t=Number(a)/1e18}catch(e){t=0}try{let t=await n.balanceOf(e);a=Number(t)/1e18}catch(e){a=0}let i=Math.max(t,a).toFixed(2),o=p.current,c=Number(i),u=Number(o);c>u?d("up"):c<u?d("down"):d("none"),l(o),p.current=i,r(i)}finally{setTimeout(()=>u(!1),450)}};i();let o=setInterval(()=>{i()},5e3);return()=>clearInterval(o)},[e,t,a]),{balance:s,prevBalance:i,direction:o,isPolling:c}}(t.address,"https://rpc-testnet.gokite.ai/","0x0fF5393387ad2f9f691FD6Fd28e07E3969e27e63");return(0,s.jsxs)("div",{className:"feed-item",style:{borderLeft:"3px solid ".concat(t.color)},children:[(0,s.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",gap:8},children:[(0,s.jsx)("strong",{children:t.name}),(0,s.jsx)("span",{className:"badge ".concat("up"===r?"ok":"down"===r?"danger":"warn"),children:i?"polling":r})]}),(0,s.jsxs)("div",{className:"mono",style:{marginTop:4,fontSize:12},children:[a," KITE"]}),(0,s.jsx)("div",{style:{marginTop:4},children:(0,s.jsxs)("a",{href:"".concat("https://testnet.kitescan.ai","/address/").concat(t.address),target:"_blank",rel:"noreferrer",className:"mono",style:{fontSize:11,color:"var(--accent-cyan)"},children:[t.address.slice(0,8),"...",t.address.slice(-6)]})})]})}var _=a(5534);let I=[{name:"Planner",address:"0xe95C796f820217bC745727761Ce7F4882B51fe7E",color:"#3b82f6"},{name:"Rider",address:"0xabbE116582398C54938B84069a23585Fb4470Bd6",color:"#22d3ee"},{name:"Foodie",address:"0xabbE116582398C54938B84069a23585Fb4470Bd6",color:"#f59e0b"},{name:"EventBot",address:"0xabbE116582398C54938B84069a23585Fb4470Bd6",color:"#f04438"}].filter(e=>!!e.address);function T(e){let{plannerUrl:t}=e,{state:a,dispatch:r}=(0,E.k)(),[o,m]=(0,n.useState)(["rider","foodie","eventbot"]),[g,v]=(0,n.useState)({rider:"Ride Researcher",foodie:"Restaurant Scout",eventbot:"Event Finder",planner:"Itinerary Planner"}),x=e=>e.replace(/[_-]+/g," ").split(" ").filter(Boolean).map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" "),w=e=>/^agent[-_][a-z0-9]+$/i.test(e)||/^[a-f0-9]{10,}$/i.test(e);(0,n.useEffect)(()=>{let e=new Set;for(let t of a.spawnedAgents)"planner"!==t.id&&e.add(t.id);for(let t of Object.keys(a.browsers))"planner"!==t&&e.add(t);for(let t of Object.keys(a.thoughts))"planner"!==t&&e.add(t);0!==e.size&&m(t=>{let a=[...t];for(let t of e)a.includes(t)||a.push(t);return a})},[a.spawnedAgents,a.browsers,a.thoughts]),(0,n.useEffect)(()=>{0!==a.spawnedAgents.length&&v(e=>{let t={...e};for(let e of a.spawnedAgents){if("planner"===e.id)continue;let a=(e.role||"").trim();a&&(w(a)||(t[e.id]=x(a)))}return t})},[a.spawnedAgents]);let S=(0,n.useMemo)(()=>{let e=new Map,t=new Map;for(let s of a.spawnedAgents)e.set(s.id,s.role||s.id),t.set(s.id,s.status||"unknown");let s=o.filter(e=>"planner"!==e).map(s=>{let n=a.browsers[s],r=a.thoughts[s]||"",i=!!((null==n?void 0:n.liveViewUrl)&&(null==n?void 0:n.status)==="active"),l=!!r.trim(),o=t.get(s)||a.agentStatuses[s]||"unknown",d="active"===o||(null==n?void 0:n.status)==="active",c=g[s]||e.get(s)||x(s);return{id:s,label:w(c)?"Specialist Agent":c,hasVideo:i,hasOutput:l,isStreaming:i||l,isActive:d,status:o}}),n=new Map;for(let e of s){let t=n.get(e.label)||[];t.push(e),n.set(e.label,t)}let r=[...Array.from(n.values()).flatMap(e=>{let t=e.filter(e=>e.isStreaming);return t.length>0?t:e})].sort((e,t)=>{let a=e.hasVideo?0:e.hasOutput?1:e.isActive?2:3,s=t.hasVideo?0:t.hasOutput?1:t.isActive?2:3;return a!==s?a-s:e.id.localeCompare(t.id)}),i=r.filter(e=>e.isStreaming);if(i.length>6)return i;let l=r.filter(e=>!e.isStreaming),d=Math.max(0,6-i.length);return[...i,...l.slice(0,d)]},[o,a.spawnedAgents,a.browsers,a.thoughts,a.agentStatuses,g]);return(0,n.useEffect)(()=>{let e="0xe95C796f820217bC745727761Ce7F4882B51fe7E";if(!e)return;let t=async()=>{try{var t;let a=await fetch("".concat(_.s$,"/api/timeline/").concat(e),{cache:"no-store"});if(!a.ok)return;let s=await a.json(),n=null===(t=s.events[0])||void 0===t?void 0:t.actionId;if(!n)return;let i=s.events.filter(e=>e.actionId===n),l=function(e){let t=new Map;for(let a of e)t.has(a.eventType)||t.set(a.eventType,a.detailsJson||{});let a=u.map((e,a)=>({step:a+1,name:e,status:t.has(e)?"pass":"pending",detail:t.has(e)?JSON.stringify(t.get(e)):void 0}));if(t.has("REQUEST_BLOCKED")){let e=t.get("REQUEST_BLOCKED")||{},s=a.find(e=>"pending"===e.status)||a[a.length-1];s&&(s.status="fail",s.name="REQUEST_BLOCKED",s.detail="".concat(p.REQUEST_BLOCKED,": ").concat(JSON.stringify(e)))}return a}(i);r({type:"MERGE_ENFORCEMENT",steps:l})}catch(e){}};t();let a=setInterval(()=>{t()},4e3);return()=>clearInterval(a)},[r]),(0,n.useEffect)(()=>{let e=async()=>{try{let e=await fetch("".concat(t,"/api/agents"),{cache:"no-store"});if(!e.ok)return;let a=await e.json();r({type:"SET_SPAWNED_AGENTS",agents:a.agents||[]})}catch(e){}};e();let a=setInterval(()=>{e()},4e3);return()=>clearInterval(a)},[r,t]),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"dashboard-home-wrap",children:(0,s.jsxs)(i(),{href:"/",className:"dashboard-home-button",children:[(0,s.jsx)(l,{size:14}),"Back to Home"]})}),(0,s.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",gap:10},children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h2",{className:"page-title",children:"Live Operations Console"}),(0,s.jsx)("p",{className:"page-subtitle",children:"Real-time planner stream, specialist browser sessions, gateway enforcement evidence, and payment events."})]}),(0,s.jsxs)("div",{className:"inline-actions",children:[(0,s.jsx)(i(),{href:"/",className:"secondary-button",children:"Back to Home"}),(0,s.jsx)(y,{plannerUrl:t})]})]}),(0,s.jsx)("div",{className:"agent-grid",style:{marginTop:14},children:S.map(e=>(0,s.jsx)(d,{label:e.label,browser:a.browsers[e.id],thought:a.thoughts[e.id]},e.id))}),(0,s.jsxs)("div",{className:"console-grid",children:[(0,s.jsxs)("div",{className:"stack",children:[(0,s.jsxs)("div",{className:"panel",children:[(0,s.jsx)("h3",{className:"panel-title",children:"Email Thread"}),(0,s.jsx)("div",{style:{marginTop:10},children:(0,s.jsx)(c,{emails:a.emails})})]}),(0,s.jsxs)("div",{className:"panel",children:[(0,s.jsx)("h3",{className:"panel-title",children:"Enforcement Pipeline"}),(0,s.jsx)("div",{style:{marginTop:10},children:(0,s.jsx)(h,{steps:a.enforcementSteps})})]})]}),(0,s.jsxs)("div",{className:"stack",children:[I.length>0&&(0,s.jsx)(N,{wallets:I}),(0,s.jsx)(f,{transactions:a.transactions,plannerUrl:t})]})]})]})}function b(){return(0,s.jsx)(T,{plannerUrl:"https://kite-planner.onrender.com"})}},5534:(e,t,a)=>{"use strict";a.d(t,{Th:()=>i,h0:()=>l,k$:()=>r,s$:()=>s});let s="https://kite-gateway.onrender.com";async function n(e){if(!e.ok)throw Error(await e.text());return e.json()}let r=async e=>n(await fetch("".concat(s,"/api/timeline/").concat(e),{cache:"no-store"})),i=async e=>n(await fetch("".concat(s,"/api/actions/").concat(e),{cache:"no-store"})),l=async e=>n(await fetch("".concat(s,"/api/passport/").concat(e),{cache:"no-store"}))},7174:(e,t,a)=>{"use strict";a.d(t,{L:()=>h,k:()=>m});var s=a(5155),n=a(2115);let r={emails:[],browsers:{},enforcementSteps:[],transactions:[],thoughts:{},agentStatuses:{},spawnedAgents:[],orchestratorPhase:"",agentPlan:[],agentResults:[],agentNodes:[{id:"planner",role:"orchestrator",status:"active"}],emailEdges:[],selectedNodeId:null,selectedEdgeId:null,inboxAddresses:{}};function i(e){return"planner"===e?"orchestrator":"rider"===e||"foodie"===e||"eventbot"===e?e:"specialist"}function l(e,t){let a=e.findIndex(e=>e.id===t.id);if(-1===a)return[...e,{id:t.id,role:t.role||i(t.id),status:t.status||"spawning",address:t.address,inboxAddress:t.inboxAddress}];let s=[...e];return s[a]={...s[a],...t,role:t.role||s[a].role,status:t.status||s[a].status},s}function o(e,t){let a=e.spawnedAgents.findIndex(e=>e.id===t.id),s=-1===a?[...e.spawnedAgents,t]:e.spawnedAgents.map((e,s)=>s===a?{...e,...t}:e);return{...e,spawnedAgents:s,agentNodes:l(e.agentNodes,{id:t.id,role:t.role,status:t.status,address:t.address,inboxAddress:t.inboxAddress})}}function d(e,t){if(e.inboxAddresses[t])return e.inboxAddresses[t];if(t.includes("planner"))return"planner";let a=e.spawnedAgents.find(e=>e.inboxAddress===t);return null==a?void 0:a.id}function c(e,t,a){let{from:s,to:n,subject:r,body:i,threadId:l}=a,o=n?d(e,n)||n:"unknown",c={id:"edge-".concat(Date.now(),"-").concat(Math.random()),fromAgentId:t.agentId,toAgentId:o,subject:r,timestamp:Date.now(),threadId:l},u={id:"mail-".concat(Date.now(),"-").concat(Math.random()),from:s,to:n,subject:r,body:i,timestamp:new Date().toISOString(),agentId:t.agentId||"planner"};return{...e,emails:[...e.emails,u],emailEdges:[...e.emailEdges,c]}}function u(e,t){switch(t.type){case"EMAIL_RECEIVED":case"EMAIL_SENT":{let a=t.payload.payload;return c(e,t.payload,{from:a.from||t.payload.agentId,to:a.to,subject:a.subject||"",body:a.body||""})}case"AGENT_EMAIL_SENT":{let a=t.payload.payload;return c(e,t.payload,{from:a.from||t.payload.agentId,to:a.to,subject:a.subject||"",body:a.body||"",threadId:a.threadId})}case"AGENT_EMAIL_RECEIVED":{let a=t.payload.payload;return function(e,t,a){let{from:s,to:n,subject:r,body:i,threadId:l}=a,o=s?d(e,s)||s:"unknown",c={id:"edge-".concat(Date.now(),"-").concat(Math.random()),fromAgentId:o,toAgentId:t.agentId,subject:r,timestamp:Date.now(),threadId:l},u={id:"mail-".concat(Date.now(),"-").concat(Math.random()),from:s,to:n,subject:r,body:i,timestamp:new Date().toISOString(),agentId:"human"===o?"human":t.agentId};return{...e,emails:[...e.emails,u],emailEdges:[...e.emailEdges,c]}}(e,t.payload,{from:a.from||"unknown",to:a.to,subject:a.subject||"",body:a.body||"",threadId:a.threadId})}case"ORCHESTRATOR_DECISION":default:return e;case"BROWSER_SESSION":{var a,s;let n=t.payload.payload,r=t.payload.agentId,i="active"===(s=n.status)||"closed"===s||"revoked"===s||"standby"===s?s:"active";return{...e,browsers:{...e.browsers,[r]:{agentId:r,liveViewUrl:n.liveViewUrl||(null===(a=e.browsers[r])||void 0===a?void 0:a.liveViewUrl),status:i,sessionId:n.sessionId}},agentNodes:l(e.agentNodes,{id:r,status:i})}}case"LLM_THINKING":return{...e,thoughts:{...e.thoughts,[t.payload.agentId]:t.payload.payload.text||""}};case"ENFORCEMENT_STEP":{let a=t.payload.payload,s={step:a.step||e.enforcementSteps.length+1,name:a.name||a.eventType||"Unknown",status:a.status||"pass",detail:a.detail};return{...e,enforcementSteps:[...e.enforcementSteps,s]}}case"PAYMENT_START":{let a=t.payload.payload,s={id:"tx-".concat(Date.now(),"-").concat(Math.random()),from:t.payload.agentId||"planner",to:a.target||"service",amount:a.amount||"0",method:a.method||"pending",status:"pending",timestamp:new Date().toISOString()};return{...e,transactions:[...e.transactions,s]}}case"PAYMENT_COMPLETE":{let a=t.payload.payload,s=[...e.transactions],n=[...s].reverse().find(e=>"pending"===e.status);return n&&(n.status="complete",n.txHash=a.txHash,n.amount=a.amount||n.amount,n.method=a.method||n.method),{...e,transactions:s}}case"PAYMENT_FAILED":{let t=[...e.transactions],a=[...t].reverse().find(e=>"pending"===e.status);return a&&(a.status="failed"),{...e,transactions:t}}case"AGENT_STATUS":{let a=t.payload.payload.status||"idle";return{...e,agentStatuses:{...e.agentStatuses,[t.payload.agentId]:a},spawnedAgents:"planner"===t.payload.agentId?e.spawnedAgents:e.spawnedAgents.map(e=>e.id===t.payload.agentId?{...e,status:a}:e),agentNodes:l(e.agentNodes,{id:t.payload.agentId,role:t.payload.payload.role||i(t.payload.agentId),status:a})}}case"AGENT_SPAWNING":{let a=t.payload.payload,s=a.step,n=a.txHash,r="failed"===s;return o(e,{id:t.payload.agentId,role:a.role||i(t.payload.agentId),address:a.address,status:r?"failed":"spawning",step:s,fundingTxHash:"funded"===s?n:void 0,passportTxHash:"passport_deployed"===s?n:void 0,sessionTxHash:"session_granted"===s?n:void 0})}case"AGENT_SPAWNED":{let a=t.payload.payload;return o(e,{id:t.payload.agentId,role:a.role||i(t.payload.agentId),address:a.address,status:"active",step:"session_granted",fundingTxHash:a.fundingTxHash,passportTxHash:a.passportTxHash,sessionTxHash:a.sessionTxHash})}case"AGENT_PLAN_CREATED":return{...e,agentPlan:t.payload.payload.agents||[]};case"ORCHESTRATOR_PHASE":return{...e,orchestratorPhase:t.payload.payload.phase||""};case"AGENT_RESULTS":{let a=t.payload.payload,s=a.results||[],n=a.synthesisBody||a.body||void 0;return{...e,agentResults:s.length>0?s:e.agentResults,synthesisBody:n||e.synthesisBody}}case"AGENT_INBOX_CREATED":{let a=t.payload.payload.inboxAddress;return{...e,inboxAddresses:{...e.inboxAddresses,[a]:t.payload.agentId},spawnedAgents:e.spawnedAgents.map(e=>e.id===t.payload.agentId?{...e,inboxAddress:a}:e),agentNodes:e.agentNodes.map(e=>e.id===t.payload.agentId?{...e,inboxAddress:a}:e)}}case"MERGE_ENFORCEMENT":return{...e,enforcementSteps:t.steps};case"SET_SPAWNED_AGENTS":{let a=t.agents.reduce((e,t)=>l(e,{id:t.id,role:t.role,status:t.status,address:t.address,inboxAddress:t.inboxAddress}),e.agentNodes);return{...e,spawnedAgents:t.agents,agentNodes:a}}case"SELECT_NODE":return{...e,selectedNodeId:t.nodeId,selectedEdgeId:null};case"SELECT_EDGE":return{...e,selectedEdgeId:t.edgeId,selectedNodeId:null};case"SET_RUN_ID":return{...e,currentRunId:t.runId};case"RESET":return r}}let p=(0,n.createContext)({state:r,dispatch:()=>void 0,switchUrl:()=>void 0});function h(e){let{url:t,children:a}=e,[i,l]=(0,n.useReducer)(u,r),o=(0,n.useRef)(void 0),{switchUrl:d}=function(e,t){let a=(0,n.useRef)(null),s=(0,n.useRef)(null),r=(0,n.useRef)(t);r.current=t;let i=(0,n.useCallback)(e=>{let t;a.current&&a.current.close(),s.current&&(clearTimeout(s.current),s.current=null);try{t=new EventSource(e)}catch(t){return s.current=setTimeout(()=>i(e),3e3),()=>void 0}a.current=t;let n=e=>{try{let t=JSON.parse(e.data);r.current(t)}catch(e){}};for(let e of["email_received","email_sent","agent_email_received","agent_email_sent","agent_spawning","agent_spawned","agent_plan_created","agent_results","agent_inbox_created","llm_thinking","llm_tool_call","browser_session","browser_screenshot","enforcement_step","payment_start","payment_complete","payment_failed","wallet_update","agent_status","orchestrator_phase","orchestrator_decision","error","replay_complete"])t.addEventListener(e,n);return t.onerror=()=>{t.close(),s.current=setTimeout(()=>i(e),3e3)},()=>{t.close(),a.current=null,s.current&&(clearTimeout(s.current),s.current=null)}},[]);return(0,n.useEffect)(()=>i(e),[e,i]),{switchUrl:(0,n.useCallback)(e=>{i(e)},[i])}}(t,(0,n.useCallback)(e=>{e.runId&&e.runId!==o.current&&(o.current=e.runId,l({type:"RESET"})),l({type:"SET_RUN_ID",runId:e.runId});let t={email_received:"EMAIL_RECEIVED",email_sent:"EMAIL_SENT",browser_session:"BROWSER_SESSION",llm_thinking:"LLM_THINKING",enforcement_step:"ENFORCEMENT_STEP",payment_start:"PAYMENT_START",payment_complete:"PAYMENT_COMPLETE",payment_failed:"PAYMENT_FAILED",agent_status:"AGENT_STATUS",agent_spawning:"AGENT_SPAWNING",agent_spawned:"AGENT_SPAWNED",agent_plan_created:"AGENT_PLAN_CREATED",orchestrator_phase:"ORCHESTRATOR_PHASE",agent_results:"AGENT_RESULTS",agent_email_sent:"AGENT_EMAIL_SENT",agent_email_received:"AGENT_EMAIL_RECEIVED",agent_inbox_created:"AGENT_INBOX_CREATED",orchestrator_decision:"ORCHESTRATOR_DECISION"}[e.type];t&&l({type:t,payload:e})},[])),c=(0,n.useMemo)(()=>({state:i,dispatch:l,switchUrl:d}),[i,d]);return(0,s.jsx)(p.Provider,{value:c,children:a})}let m=()=>(0,n.useContext)(p)},7401:(e,t,a)=>{"use strict";a.d(t,{A:()=>o});var s=a(2115);let n=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),r=function(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return t.filter((e,t,a)=>!!e&&""!==e.trim()&&a.indexOf(e)===t).join(" ").trim()};var i={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let l=(0,s.forwardRef)((e,t)=>{let{color:a="currentColor",size:n=24,strokeWidth:l=2,absoluteStrokeWidth:o,className:d="",children:c,iconNode:u,...p}=e;return(0,s.createElement)("svg",{ref:t,...i,width:n,height:n,stroke:a,strokeWidth:o?24*Number(l)/Number(n):l,className:r("lucide",d),...p},[...u.map(e=>{let[t,a]=e;return(0,s.createElement)(t,a)}),...Array.isArray(c)?c:[c]])}),o=(e,t)=>{let a=(0,s.forwardRef)((a,i)=>{let{className:o,...d}=a;return(0,s.createElement)(l,{ref:i,iconNode:t,className:r("lucide-".concat(n(e)),o),...d})});return a.displayName="".concat(e),a}},9441:(e,t,a)=>{Promise.resolve().then(a.bind(a,5113))}},e=>{var t=t=>e(e.s=t);e.O(0,[582,441,587,358],()=>t(9441)),_N_E=e.O()}]);